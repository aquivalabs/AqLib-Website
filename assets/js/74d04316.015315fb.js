"use strict";(self.webpackChunkAqLib_documentation_website=self.webpackChunkAqLib_documentation_website||[]).push([[6192],{28453:(e,l,t)=>{t.d(l,{R:()=>o,x:()=>c});var i=t(96540);const s={},n=i.createContext(s);function o(e){const l=i.useContext(n);return i.useMemo(function(){return"function"==typeof e?e(l):{...l,...e}},[l,e])}function c(e){let l;return l=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(n.Provider,{value:l},e.children)}},51178:(e,l,t)=>{t.r(l),t.d(l,{assets:()=>r,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"apex/core/AqSoql","title":"AqSoql","description":"Builder class for SOQL quieries","source":"@site/../documentation/apex/core/AqSoql.md","sourceDirName":"apex/core","slug":"/apex/core/AqSoql","permalink":"/apex/core/AqSoql","draft":false,"unlisted":false,"editUrl":"https://bitbucket.org/aquiva/aqlib/src/main/documentation/../documentation/apex/core/AqSoql.md","tags":[],"version":"current","lastUpdatedBy":"Artem Kniazev","lastUpdatedAt":1721818396000,"frontMatter":{"layout":"default","autogenerated":true},"sidebar":"documentation","previous":{"title":"AqSecurity","permalink":"/apex/core/AqSecurity"},"next":{"title":"AqSosl","permalink":"/apex/core/AqSosl"}}');var s=t(74848),n=t(28453);const o={layout:"default",autogenerated:!0},c="AqSoql",r={},a=[{value:"Constructors",id:"constructors",level:2},{value:"<code>public AqSoql(SObjectType objType)</code>",id:"public-aqsoqlsobjecttype-objtype",level:3},{value:"<code>public AqSoql(String objTypeName)</code>",id:"public-aqsoqlstring-objtypename",level:3},{value:"<code>public AqSoql(SObjectField lookupField, SObjectType childObjectType)</code>",id:"public-aqsoqlsobjectfield-lookupfield-sobjecttype-childobjecttype",level:3},{value:"Parameters",id:"parameters",level:4},{value:"Example",id:"example",level:4},{value:"<code>public AqSoql(AqSoql soql)</code>",id:"public-aqsoqlaqsoql-soql",level:3},{value:"Methods",id:"methods",level:2},{value:"<code>public AqSoql withColumns(List&lt;String&gt; cols)</code>",id:"public-aqsoql-withcolumnsliststring-cols",level:3},{value:"Example",id:"example-1",level:4},{value:"<code>public AqSoql withAggregation(List&lt;AqAggregation&gt; aggregations)</code>",id:"public-aqsoql-withaggregationlistaqaggregation-aggregations",level:3},{value:"Example",id:"example-2",level:4},{value:"<code>public AqSoql withGroupBy(List&lt;String&gt; gb)</code>",id:"public-aqsoql-withgroupbyliststring-gb",level:3},{value:"Example",id:"example-3",level:4},{value:"<code>public AqSoql withWhere(String wc)</code>",id:"public-aqsoql-withwherestring-wc",level:3},{value:"Example",id:"example-4",level:4},{value:"<code>public AqSoql withSubSelects(List&lt;AqSoql&gt; ss)</code>",id:"public-aqsoql-withsubselectslistaqsoql-ss",level:3},{value:"Example",id:"example-5",level:4},{value:"<code>public AqSoql withRowLimit(Integer rl)</code>",id:"public-aqsoql-withrowlimitinteger-rl",level:3},{value:"Example",id:"example-6",level:4},{value:"<code>public AqSoql withOrderBy(List&lt;String&gt; ob)</code>",id:"public-aqsoql-withorderbyliststring-ob",level:3},{value:"Example",id:"example-7",level:4},{value:"<code>public AqSoql withoutSecurityEnforced()</code>",id:"public-aqsoql-withoutsecurityenforced",level:3},{value:"Example",id:"example-8",level:4},{value:"<code>public AqSoql withSecurityEnforced()</code>",id:"public-aqsoql-withsecurityenforced",level:3},{value:"Example",id:"example-9",level:4},{value:"<code>public AqSoql withUserMode()</code>",id:"public-aqsoql-withusermode",level:3},{value:"Example",id:"example-10",level:4},{value:"<code>public String getQueryString()</code>",id:"public-string-getquerystring",level:3},{value:"Example",id:"example-11",level:4},{value:"<code>public List&lt;AggregateResult&gt; aggregate()</code>",id:"public-listaggregateresult-aggregate",level:3},{value:"Example",id:"example-12",level:4},{value:"<code>public Integer countQuery()</code>",id:"public-integer-countquery",level:3},{value:"Example",id:"example-13",level:4},{value:"<code>public static String getBaseSoql(SObjectType objectType, Set&lt;String&gt; columns)</code>",id:"public-static-string-getbasesoqlsobjecttype-objecttype-setstring-columns",level:3},{value:"Example",id:"example-14",level:4},{value:"<code>public static String getBaseSoql(SObjectType objectType, List&lt;String&gt; columns, List&lt;AqSoql&gt; subSelects)</code>",id:"public-static-string-getbasesoqlsobjecttype-objecttype-liststring-columns-listaqsoql-subselects",level:3},{value:"Example",id:"example-15",level:4}];function d(e){const l={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:["[ This file is autogenerated from apexdoc ]","\n",(0,s.jsx)(l.header,{children:(0,s.jsx)(l.h1,{id:"aqsoql",children:"AqSoql"})}),"\n",(0,s.jsx)(l.p,{children:"Builder class for SOQL quieries"}),"\n",(0,s.jsxs)(l.p,{children:[(0,s.jsx)(l.strong,{children:"Group"})," apex/core"]}),"\n",(0,s.jsx)(l.h2,{id:"constructors",children:"Constructors"}),"\n",(0,s.jsx)(l.h3,{id:"public-aqsoqlsobjecttype-objtype",children:(0,s.jsx)(l.code,{children:"public AqSoql(SObjectType objType)"})}),"\n",(0,s.jsx)(l.h3,{id:"public-aqsoqlstring-objtypename",children:(0,s.jsx)(l.code,{children:"public AqSoql(String objTypeName)"})}),"\n",(0,s.jsx)(l.h3,{id:"public-aqsoqlsobjectfield-lookupfield-sobjecttype-childobjecttype",children:(0,s.jsx)(l.code,{children:"public AqSoql(SObjectField lookupField, SObjectType childObjectType)"})}),"\n",(0,s.jsx)(l.p,{children:"Constructor for sub-select queries"}),"\n",(0,s.jsx)(l.h4,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsxs)(l.table,{children:[(0,s.jsx)(l.thead,{children:(0,s.jsxs)(l.tr,{children:[(0,s.jsx)(l.th,{children:"Param"}),(0,s.jsx)(l.th,{children:"Description"})]})}),(0,s.jsxs)(l.tbody,{children:[(0,s.jsxs)(l.tr,{children:[(0,s.jsx)(l.td,{children:(0,s.jsx)(l.code,{children:"lookupField"})}),(0,s.jsx)(l.td,{children:"a lookup SObjectField"})]}),(0,s.jsxs)(l.tr,{children:[(0,s.jsx)(l.td,{children:(0,s.jsx)(l.code,{children:"childObjectType"})}),(0,s.jsx)(l.td,{children:"SObjectType for a child"})]})]})]}),"\n",(0,s.jsx)(l.h4,{id:"example",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"List<String> FIELDS_FOR_SELECTION = {'Name'};\n Integer SEARCH_RESULTS_LIMIT = 1000;\n public static List<Account> searchAccounts(String name) {\n     String condition = 'Name = :name';\n     List<String> orderFields = { 'Name' };\n     AqSoql aqSoql = new AqSoql(Account.getSObjectType())\n         .withColumns(FIELDS_FOR_SELECTION)\n         .withWhere(condition)\n         .withOrderBy(orderFields)\n         .withRowLimit(SEARCH_RESULTS_LIMIT);\n     return Database.query(aqSoql.getQueryString());\n }\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-aqsoqlaqsoql-soql",children:(0,s.jsx)(l.code,{children:"public AqSoql(AqSoql soql)"})}),"\n",(0,s.jsx)(l.hr,{}),"\n",(0,s.jsx)(l.h2,{id:"methods",children:"Methods"}),"\n",(0,s.jsx)(l.h3,{id:"public-aqsoql-withcolumnsliststring-cols",children:(0,s.jsx)(l.code,{children:"public AqSoql withColumns(List<String> cols)"})}),"\n",(0,s.jsx)(l.p,{children:"Set columns list you want to select"}),"\n",(0,s.jsx)(l.h4,{id:"example-1",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"List<String> columnsToSelect = {'Name', 'Address__c'};\nAqSoql soql = new AqSoql(obj)\n     .withColumns(columnsToSelect);\nList<Object> result = Database.query(soql.getQueryString());\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-aqsoql-withaggregationlistaqaggregation-aggregations",children:(0,s.jsx)(l.code,{children:"public AqSoql withAggregation(List<AqAggregation> aggregations)"})}),"\n",(0,s.jsx)(l.p,{children:"Use to construct query with aggregations"}),"\n",(0,s.jsx)(l.h4,{id:"example-2",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"AqAggregation ag = AqAggregation.max(AqTestObject__c.Date__c, 'alias');\n// queries the Maximum value of 'Date__c' field of 'AqTestObject__c' object\nAqSoql soql = new AqSoql(obj)\n     .withAggregation(new List<AqAggregation> { ag });\nList<AggregateResult> results = soql.aggregate();\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-aqsoql-withgroupbyliststring-gb",children:(0,s.jsx)(l.code,{children:"public AqSoql withGroupBy(List<String> gb)"})}),"\n",(0,s.jsx)(l.p,{children:"Set GROUP BY columns for Aggregation querries only."}),"\n",(0,s.jsx)(l.h4,{id:"example-3",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"List<String> columnsToSelect = {'Name', 'Address__c'};\nList<String> groubBy = {'Name'};\nAqAggregation ag = AqAggregation.max(AqTestObject__c.Date__c, 'alias');\nAqSoql soql = new AqSoql(obj)\n     .withColumns(columnsToSelect)\n     .withAggregation(new List<AqAggregation> { ag })\n     .withGroupBy(groubBy); // groups results by 'Name' field\nList<AggregateResult> results = soql.aggregate();\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-aqsoql-withwherestring-wc",children:(0,s.jsx)(l.code,{children:"public AqSoql withWhere(String wc)"})}),"\n",(0,s.jsx)(l.p,{children:"Set WHERE condition to query"}),"\n",(0,s.jsx)(l.h4,{id:"example-4",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"List<String> columnsToSelect = {'Name', 'Address__c'};\n// returns records Where Name is not Bull\nAqSoql soql = new AqSoql(obj)\n     .withWhere('Name != NULL')\n     .withColumns(columnsToSelect);\nList<Object> result = Database.query(soql.getQueryString());\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-aqsoql-withsubselectslistaqsoql-ss",children:(0,s.jsx)(l.code,{children:"public AqSoql withSubSelects(List<AqSoql> ss)"})}),"\n",(0,s.jsx)(l.p,{children:"Add sub query to your query"}),"\n",(0,s.jsx)(l.h4,{id:"example-5",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"AqSoql subQuery = new AqSoql('Relation__r')\n     .withColumns('Price');\nList<String> columnsToSelect = {'Name', 'Address__c'};\nAqSoql soql = new AqSoql(obj)\n     .withColumns(columnsToSelect)\n     // queries each object record with 'Relation__c' related records list\n     .withSubSelects(new List<AqSoql>{subQuery});\nList<Object> result = Database.query(soql.getQueryString());\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-aqsoql-withrowlimitinteger-rl",children:(0,s.jsx)(l.code,{children:"public AqSoql withRowLimit(Integer rl)"})}),"\n",(0,s.jsx)(l.p,{children:"Set query records LIMIT"}),"\n",(0,s.jsx)(l.h4,{id:"example-6",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"List<String> columnsToSelect = {'Name', 'Address__c'};\nAqSoql soql = new AqSoql(obj)\n     .withColumns(columnsToSelect)\n     // selects only first 1000 records\n     .withRowLimit(1000);\nList<Object> result = Database.query(soql.getQueryString());\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-aqsoql-withorderbyliststring-ob",children:(0,s.jsx)(l.code,{children:"public AqSoql withOrderBy(List<String> ob)"})}),"\n",(0,s.jsx)(l.p,{children:"Set ORDER BY parameter to query"}),"\n",(0,s.jsx)(l.h4,{id:"example-7",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"List<String> columnsToSelect = {'Name', 'Address__c'};\nAqSoql soql = new AqSoql(obj)\n     // displays records odered by 'Name' field and Descending\n     .withOrderBy(new List<String>{ 'Name DESC' })\n     .withColumns(columnsToSelect);\nList<Object> result = Database.query(soql.getQueryString());\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-aqsoql-withoutsecurityenforced",children:(0,s.jsx)(l.code,{children:"public AqSoql withoutSecurityEnforced()"})}),"\n",(0,s.jsxs)(l.p,{children:["Use it to omit ",(0,s.jsx)(l.code,{children:"WITH SECURITY_ENFORCED"})," and ",(0,s.jsx)(l.code,{children:"WITH USER_MODE"})," settings. Default value is ",(0,s.jsx)(l.code,{children:"WITH SECURITY_ENFORCED"})]}),"\n",(0,s.jsx)(l.h4,{id:"example-8",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"List<String> columnsToSelect = {'Name', 'Address__c'};\nAqSoql soql = new AqSoql(obj)\n     // displays records odered by 'Name' field and Descending\n     .withOrderBy(new List<String>{ 'Name DESC' })\n     .withColumns(columnsToSelect)\n     .withoutSecurityEnforced();\nList<Object> result = Database.query(soql.getQueryString());\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-aqsoql-withsecurityenforced",children:(0,s.jsx)(l.code,{children:"public AqSoql withSecurityEnforced()"})}),"\n",(0,s.jsxs)(l.p,{children:["Use it to set security level to ",(0,s.jsx)(l.code,{children:"WITH SECURITY_ENFORCED"}),". Turned on by default."]}),"\n",(0,s.jsx)(l.h4,{id:"example-9",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"List<String> columnsToSelect = {'Name', 'Address__c'};\nAqSoql soql = new AqSoql(obj)\n     // displays records odered by 'Name' field and Descending\n     .withOrderBy(new List<String>{ 'Name DESC' })\n     .withColumns(columnsToSelect)\n     .withSecurityEnforced();\nList<Object> result = Database.query(soql.getQueryString());\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-aqsoql-withusermode",children:(0,s.jsx)(l.code,{children:"public AqSoql withUserMode()"})}),"\n",(0,s.jsxs)(l.p,{children:["Use it to set security level to ",(0,s.jsx)(l.code,{children:"WITH USER_MODE"})," which enforces sharing regardless of class declaration."]}),"\n",(0,s.jsx)(l.h4,{id:"example-10",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"List<String> columnsToSelect = {'Name', 'Address__c'};\nAqSoql soql = new AqSoql(obj)\n    .withColumns(columnsToSelect)\n    .withUserMode();\ntry {\n    List<Object> result = Database.query(soql.getQueryString());\n} catch (QueryException ex) {\n    throw new Aq.QueryPermissionException(ex);\n}\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-string-getquerystring",children:(0,s.jsx)(l.code,{children:"public String getQueryString()"})}),"\n",(0,s.jsx)(l.p,{children:"Use it as a final builder method to return assembled SOQL query"}),"\n",(0,s.jsx)(l.h4,{id:"example-11",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"AqSoql soql = new AqSoql(obj)\n     .withColumns(new List<String>{ 'Name' });\nString soqlQuery = soql.getQueryString();\nList<sObjects> records = Database.query(soqlQuery);\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-listaggregateresult-aggregate",children:(0,s.jsx)(l.code,{children:"public List<AggregateResult> aggregate()"})}),"\n",(0,s.jsx)(l.p,{children:"Use it as a final method for aggregation querries"}),"\n",(0,s.jsx)(l.h4,{id:"example-12",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"AqAggregation ag = AqAggregation.max(AqTestObject__c.Date__c, 'alias');\nAqSoql soql = new AqSoql(obj)\n     .withAggregation(new List<AqAggregation> { ag });\nList<AggregateResult> results = soql.aggregate();\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-integer-countquery",children:(0,s.jsx)(l.code,{children:"public Integer countQuery()"})}),"\n",(0,s.jsx)(l.p,{children:"Use it as a final method for COUNT querries"}),"\n",(0,s.jsx)(l.h4,{id:"example-13",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"AqSoql soql = new AqSoql(obj)\n     .withWhere('RequiredText__c != NULL);\n// counts all records instead of quering it\nInteger numberOfRecords = soql.countQuery();\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-static-string-getbasesoqlsobjecttype-objecttype-setstring-columns",children:(0,s.jsx)(l.code,{children:"public static String getBaseSoql(SObjectType objectType, Set<String> columns)"})}),"\n",(0,s.jsx)(l.p,{children:"Assemble SOQL string for a given SObjectType and columns set"}),"\n",(0,s.jsx)(l.h4,{id:"example-14",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"Set<String> columnsToSelect = {'Name', 'Address__c'};\nString soqlQuery = AqSoql.getBaseSoql(obj, columnsToSelect);\nList<sObjects> records = Database.query(soqlQuery);\n"})}),"\n",(0,s.jsx)(l.h3,{id:"public-static-string-getbasesoqlsobjecttype-objecttype-liststring-columns-listaqsoql-subselects",children:(0,s.jsx)(l.code,{children:"public static String getBaseSoql(SObjectType objectType, List<String> columns, List<AqSoql> subSelects)"})}),"\n",(0,s.jsx)(l.p,{children:"Assemble SOQL string for a given SObjectType, columns set and sub queries list"}),"\n",(0,s.jsx)(l.h4,{id:"example-15",children:"Example"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-apex",children:"AqSoql subQuery = new AqSoql('Relation__r')\n     .withColumns('Price');\nList<AqSoql> subQueries = new List<AqSoql>{ subQuery };\nSet<String> columnsToSelect = {'Name', 'Address__c'};\nString soqlQuery = AqSoql.getBaseSoql(obj, columnsToSelect, subQueries)\n"})}),"\n",(0,s.jsx)(l.hr,{})]})}function u(e={}){const{wrapper:l}={...(0,n.R)(),...e.components};return l?(0,s.jsx)(l,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);